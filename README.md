## Boson

<p align="center">
    <a href="https://packagist.org/packages/serafim/boson"><img src="https://poser.pugx.org/serafim/boson/require/php?style=for-the-badge" alt="PHP 8.4+"></a>
    <a href="https://packagist.org/packages/serafim/boson"><img src="https://poser.pugx.org/serafim/boson/version?style=for-the-badge" alt="Latest Stable Version"></a>
    <a href="https://packagist.org/packages/serafim/boson"><img src="https://poser.pugx.org/serafim/boson/v/unstable?style=for-the-badge" alt="Latest Unstable Version"></a>
    <a href="https://raw.githubusercontent.com/SerafimArts/Boson/blob/master/LICENSE"><img src="https://poser.pugx.org/serafim/boson/license?style=for-the-badge" alt="License MIT"></a>
    <a href="https://github.com/xepozz/meta-storm-idea-plugin"><img src="https://img.shields.io/static/v1?label=Powered+by&message=Meta+Storm&color=db5860&style=for-the-badge&logo=data:image/svg%2bxml;base64,PHN2ZyB3aWR0aD0iMTExIiBoZWlnaHQ9IjExMSIgdmlld0JveD0iMCAwIDExMSAxMTEiIGZpbGw9Im5vbmUiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+PHBhdGggZD0iTTYwLjQ2MTcgOEwzMC4xNjU0IDguMjQ3OUMyNy4yNDYgOC4yNzE3OSAyNC42NDggMTAuMTA1IDIzLjY0NyAxMi44NDc1TDAuNDMwNTkgNzYuODMxNEMtMS4yNDQ1OSA4MS40MjA4IDIuMTc4MDUgODYuMjcxMyA3LjA2MzUzIDg2LjIzMTNMMzIuMTE5NyA4Ni4wMjYzTDM1LjQxNDcgNzYuOTk5TDkuODczOTEgNzcuMjA4TDMxLjYyNTkgMTcuMjM2Mkw1Ny4xNjY2IDE3LjAyNzNMNjAuNDYxNyA4WiIgZmlsbD0iI0FGQjFCMyIvPjxwYXRoIGQ9Ik00OS40MTQ5IDEwMi45OTlMNzkuNzEyMiAxMDIuOTk5QzgyLjYzMTcgMTAyLjk5OSA4NS4yNDQ2IDEwMS4xODcgODYuMjY4IDk4LjQ1MjlMMTEwLjAxMyAzNC40NTI0QzExMS43MjYgMjkuODc2OCAxMDguMzQzIDI0Ljk5ODUgMTAzLjQ1NyAyNC45OTg1TDc4LjQwMDQgMjQuOTk4NUw3NS4wMzE2IDMzLjk5ODVMMTAwLjU3MyAzMy45OTg1TDc4LjMyNTMgOTMuOTk5TDUyLjc4MzcgOTMuOTk5TDQ5LjQxNDkgMTAyLjk5OVoiIGZpbGw9IiNBRkIxQjMiLz48cGF0aCBkPSJNMjIgNjFMODYgOEw1NyA1MEw4OS45OTk3IDQ5Ljk5OTdMMjYgMTAzTDU1IDYxSDIyWiIgZmlsbD0iI0M3NTQ1MCIvPjwvc3ZnPg==" alt="MetaStorm"></a>
</p>
<p align="center">
    <a href="https://github.com/SerafimArts/Boson/actions/workflows/tests.yml"><img src="https://img.shields.io/github/actions/workflow/status/SerafimArts/Boson/tests.yml?label=Tests&style=flat-square&logo=unpkg"></a>
    <a href="https://github.com/SerafimArts/Boson/actions/workflows/codestyle.yml"><img src="https://img.shields.io/github/actions/workflow/status/SerafimArts/Boson/codestyle.yml?label=PER-2+CodeStyle&style=flat-square&logo=telegraph"></a>
    <a href="https://github.com/SerafimArts/Boson/actions/workflows/static-analysis.yml"><img src="https://img.shields.io/github/actions/workflow/status/SerafimArts/Boson/static-analysis.yml?label=PHPStan&style=flat-square&logo=data:image/png;base64,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"></a>
</p>

Why Boson? Because it's not an [Electron](https://www.electronjs.org)! 
And much easier than that =)

> Also, this repository contains included high level PHP bindings 
> [for webview v0.12.0](https://github.com/webview/webview).

- [Simple Example](#simple-example)
- [Requirements](#requirements)
  - [Windows](#windows)
  - [Linux & BSD](#linux-and-bsd)
    - [Debian](#debian)
    - [Fedora](#fedora)
    - [FreeBSD](#freebsd)
  - [MacOS](#macos)
- [Usage](#usage)
  - **Window**
    - [Window Title](#window-title)
    - [Window Resizing](#window-resizing)
    - [Window Max Size](#window-max-size)
    - [Window Min Size](#window-min-size)
    - [Window Fixed Size](#window-fixed-size)
    - [Window Dark Mode](#window-dark-mode)
  - **WebView**
    - [HTML Content](#webview-html-content)
    - [Load Content From URL](#webview-url)
    - **Styles**
      - [Global Styles](#global-styles)
    - **JavaScript**
      - [Global Scripts](#global-scripts)
      - [Creating Functions](#creating-functions)
      - [Code Evaluation](#code-evaluation)
      - [Code Requests](#code-requests)
  - **Misc**
    - [Quit](#quit) 
    - [Debug Mode](#debug-mode)
    - [Custom Library](#custom-library)

## Simple Example

```php
use Serafim\Boson\Application;

$app = new Application();

$app->webview->html = <<<'HTML'
    <button onclick="foo('HELLO');">Hello</button>
    HTML;

$app->webview->bind('foo', function (string $message): void {
    var_dump($message);
});

$app->run();
```

## Requirements

- PHP ^8.4
  - ext-ffi

| Platform | X86 | AMD64 | ARM64 | Technologies                                                                                                                                                        |
|----------|-----|-------|-------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| Windows  | ✓   | ✓     | ✖     | [Windows API](https://docs.microsoft.com/en-us/windows/win32/apiindex/windows-api-list), [WebView2](https://developer.microsoft.com/en-us/microsoft-edge/webview2/) |
| Linux    | ✓   | ✓     | ✓     | [GTK](https://gtk.org/), [WebKitGTK](https://webkitgtk.org/)                                                                                                        |
| macOS    | ✓   | ✓     | ✓     | Cocoa, [WebKit](https://webkit.org/)                                                                                                                                |

### Windows

Requires Windows 10 or higher.

End-users must have the [WebView2 runtime](https://developer.microsoft.com/en-us/microsoft-edge/webview2/) 
installed on their system for any version of Windows before Windows 11.

Note: A pre-builded version of the bridge already comes with 
     the portability package in [`bin/WebView2Loader.dll`](./bin). No any 
     additional installation required.

### Linux and BSD

The [GTK](https://gtk.org/) and [WebKitGTK](https://webkitgtk.org/) libraries 
are required. You need to check your package repositories regarding which 
packages to install.

#### Debian

**WebKitGTK 6.0, GTK 4**

```shell
apt install libgtk-4-1 libwebkitgtk-6.0-4
```

**WebKitGTK 4.1, GTK 3, libsoup 3**

```shell
apt install libgtk-3-0 libwebkit2gtk-4.1-0
```

**WebKitGTK 4.0, GTK 3, libsoup 2**

```shell
apt install libgtk-3-0 libwebkit2gtk-4.0-37
```

#### Fedora

**WebKitGTK 6.0, GTK 4**

```shell
dnf install gtk4 webkitgtk6.0
```

**WebKitGTK 4.1, GTK 3, libsoup 3**

```shell
dnf install gtk3 webkit2gtk4.1
```

**WebKitGTK 4.0, GTK 3, libsoup 2**

```shell
dnf install gtk3 webkit2gtk4.0
```

#### FreeBSD

**GTK 4**

```shell
pkg install webkit2-gtk4
```

**GTK 3**

```shell
pkg install webkit2-gtk3
```

### MacOS

It appears that no additional dependencies are required.

## Usage

> This documentation corresponds to the latest release (see https://github.com/SerafimArts/Boson/tags). 
> Behavior and code in the `master` branch may differ from what is shown below.

### Window Title

To get or update the title, you should change the `$title` property

```php
$app = new Serafim\Boson\Application();

$app->webview->title = 'New Title';

echo 'Current Title: ' . $app->webview->title;

$app->run();
```

Or set title from configuration

```php
$app = new Serafim\Boson\Application(
    window: new Serafim\Boson\Window\NewWindowCreateInfo(
        title: 'New Title'
    ),
);

$app->run();
```

### Window Resizing

To change the size, use the `resize()` method.

```php
$app = new Serafim\Boson\Application();

$app->window->resize(640, 480);

$app->run();
```

Or set size from configuration

```php
$app = new Serafim\Boson\Application(
    window: new Serafim\Boson\Window\NewWindowCreateInfo(
        width: 640,
        height: 480,
    ),
);

$app->run();
```

### Window Max Size

To change the max size, use the `resize()` method.

> [Linux/GTK4]: Using `WindowSizeHint::MaxBounds` for setting the maximum window 
> size is not supported with GTK 4 (Linux platform) because X11-specific 
> functions such as `gtk_window_set_geometry_hints` were removed.
> This option has no effect when using GTK 4.

```php
$app = new Serafim\Boson\Application();

$app->window->resize(640, 480, \Serafim\Boson\Window\WindowSizeHint::MaxBounds);

$app->run();
```


### Window Min Size

To change the min size, use the `resize()` method.

```php
$app = new Serafim\Boson\Application();

$app->window->resize(640, 480, \Serafim\Boson\Window\WindowSizeHint::MinBounds);

$app->run();
```


### Window Fixed Size

To set the fixed size, use the `resize()` method.

```php
$app = new Serafim\Boson\Application();

$app->window->resize(640, 480, \Serafim\Boson\Window\WindowSizeHint::Fixed);

$app->run();
```


### Window Dark Mode

To set the dark mode (dark theme), use the `$darkMode` window property.

> [Linux]: Currently not supported, this option has no effect

> [MacOS]: Currently not supported, this option has no effect

```php
$app = new Serafim\Boson\Application();

$app->window->darkMode = true;

$app->run();
```

Or set dark mode from configuration

```php
$app = new Serafim\Boson\Application(
    window: new Serafim\Boson\Window\NewWindowCreateInfo(
        darkMode: true,
    ),
);

$app->run();
```

### WebView HTML Content

To set the content, you should use the `$html` property

```php
$app = new Serafim\Boson\Application();

$app->webview->html = '<button>Do Not Click Me!</button>';

$app->run();
```

Or set html content from configuration

```php
$app = new Serafim\Boson\Application(
    window: new Serafim\Boson\Window\NewWindowCreateInfo(
        webview: new Serafim\Boson\WebView\HTMLWebViewCreateInfo(
            html: '<button>Do Not Click Me!</button>',
        ),
    ),
);

$app->run();
```

Please note that reading this property is NOT possible. If you need to
read the contents, use the [data retrieval method](#webview-requests).

```php
$app = new Serafim\Boson\Application();

$app->webview->request('document.body.innerHTML')
    ->then(function (string $html) {
        var_dump($html);
    });

$app->run();
```


### WebView URL

To load content from the URL, you should use the `$url` property

```php
$app = new Serafim\Boson\Application();

$app->webview->url = 'https://nesk.me';

$app->run();
```

Or set URL from configuration

```php
$app = new Serafim\Boson\Application(
    window: new Serafim\Boson\Window\NewWindowCreateInfo(
        webview: new Serafim\Boson\WebView\URLWebViewCreateInfo(
            url: 'https://nesk.me',
        ),
    ),
);

$app->run();
```


### Global Styles

You can register a CSS style that will be applied to any page

```php
$app = new Serafim\Boson\Application();

$app->webview->styleBeforeLoad(<<<'CSS'
    body {
        background: #900;
    }
    CSS);

$app->run();
```

Or set styles from configuration

```php
$app = new Serafim\Boson\Application(
    window: new Serafim\Boson\Window\NewWindowCreateInfo(
        webview: new Serafim\Boson\WebView\WebViewCreateInfo(
            styles: [<<<'CSS'
                body {
                    background: #900;
                }
                CSS],
        ),
    ),
);

$app->run();
```


### Global Scripts

You can register a JavaScript code that will be applied to any page

```php
$app = new Serafim\Boson\Application();

$app->webview->evalBeforeLoad(<<<'JS'
    alert('hello');
    JS);

$app->run();
```

Or set scripts from configuration

```php
$app = new Serafim\Boson\Application(
    window: new Serafim\Boson\Window\NewWindowCreateInfo(
        webview: new Serafim\Boson\WebView\WebViewCreateInfo(
            scripts: [<<<'JS'
                alert('hello');
                JS],
        ),
    ),
);

$app->run();
```


### Creating Functions

You can create a function that can be called directly from WebView

```php
$app = new Serafim\Boson\Application();

$app->webview->bind('foo', function () { 
    var_dump('Executed!');
});

$app->run();
```

Or set functions list from configuration

```php
$app = new Serafim\Boson\Application(
    window: new Serafim\Boson\Window\NewWindowCreateInfo(
        webview: new Serafim\Boson\WebView\WebViewCreateInfo(
            functions: ['foo' => function () { 
                var_dump('Executed!');
            }],
        ),
    ),
);

$app->run();
```


### Code Evaluation

You can execute arbitrary code directly on current WebView

```php
$app = new Serafim\Boson\Application();

$app->webview->eval('document.write("Hello World!")');

$app->run();
```


### Code Requests

You can directly get data from WebView context

```php
$app = new Serafim\Boson\Application();

$app->webview->request('document.location')
    ->then(function (array $data) {
        var_dump($data);
    });

$app->run();
```


### Quit

To exit the application, you should call the `quit()` method

```php
$app = new Serafim\Boson\Application();

$app->webview->html = '<button onclick="quit()">exit</button>';

$app->webview->bind('quit', function () use ($app) {
    $app->quit();
});

$app->run();
```


### Debug Mode

To enable debug mode, you should define the `debug: ?bool` 
argument of the `Application` instance.

```php
$app = new Serafim\Boson\Application(
    // true  - enable debug mode
    // false - disable debug mode
    // null  - autodetect debug mode
    debug: true, 
);

$app->run();
```


### Custom Library

To define binary, you should define the `library: ?non-empty-string`
argument of the `Application` instance.

```php
$app = new Serafim\Boson\Application(
    // string - defines pathname to the library
    // null   - autodetect library
    library: __DIR__ . '/path/to/custom-webview.so',
);

$app->run();
```
